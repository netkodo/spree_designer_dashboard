<div class="row">
    <div class="col-md-3 col-sm-12 col-xs-12">
        <%= render :partial => "spree/boards/dashboard_menu", :locals => {:selected => "projects"} %>
    </div>

    <div class="col-md-9 col-sm-12 col-xs-12">
      <% unless @projects.present? %>
          <div class="col-md-12 col-sm-12 col-xs-12 text-center">
            <h1>You do not have any projects</h1>
            <%= link_to "Add One", new_project_path, :class => "btn btn-primary" %>
          </div>
      <% else %>
        <div class="col-md-12 text-center">
          <h1 id="h1_project_name"> <%= @selected_project.present? ? "#{@selected_project.project_name} Project" : "" %> </h1>
        </div>
        <div class="row">
          <div class="col-md-6 col-md-offset-3 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0">
            <%= select_tag :project_select, options_for_select(@projects.map{|p| [p.project_name,p.id]}.unshift(["Start or Select Project","",{disabled: 'disabled'}],["Start New Project","new_project",{class: 'bold'}],["--------------------------------","divider",{disabled: 'disabled', class: 'text-center'}]),"#{@selected_project.present? ? @selected_project.id : ''}"), :class => 'form-control' %>
          </div>
        </div>
        <div class="project-managment <%= @selected_project.present? ? "" : "hidden" %>">
          <div class="row mtop">
            <div class="col-md-6 col-md-offset-3 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0">
              <%= select_tag :project_action, options_for_select([["Select an Option","",{disabled: 'disabled'}],["Edit / View Project Details","project-details"],["Add a Room for this Project","add-room"],["Open Project","end-project"],["Remove Project","remove-project"]],""),class:"form-control", data: {id: @selected_project.present? ? @selected_project.id : '', status: "open"} %>
            </div>
          </div>
          <div class="row mtop">
            <div class="col-md-12 text-center">
              <div id="submit-action" class="btn btn-primary btn-no-radius">Submit</div>
            </div>
          </div>
        </div>
        <table class="table table-board-listing">
          <colgroup>
            <col style="width: 5%" />
            <col style="width: 20%" />
            <col style="width: 75%" />
          </colgroup>
          <thead>
          <tr>
            <th colspan="3">&nbsp;</th>
          </tr>
          </thead>
          <tbody class=" table-board-listing project">
          <%# @projects.each do |p| %>
            <% @boards.each do |board| %>
              <tr id="<%= board.id %>" class="<%= board.private %> board<%= board.id %> project<%= board.project_id %> <%= (@selected_project.present? and board.project_id==@selected_project.id) ? '' : 'hidden' %>">
                <td class="status"><span class="label label-<%= board.display_short_status.downcase %>"><%= board.display_short_status %></span></td>
                <td class="board-thumb">
                  <%= board_image(board,:small)%>
                </td>
                <td class="board-title">
                  <%= board.name %>
                  <div class="board-actions" data-project_id="<%= board.project_id %>" data-board_id="<%= board.id %>" data-user_id="<%= spree_current_user.id %>">
                      <%= link_to "Preview", preview_board_path(board), :class => "btn btn-default btn-sm"%>
                      <%= link_to "Edit", design_board_path(board), :class => "btn btn-default btn-sm"%>
                      <div class="btn btn-default btn-sm js-private-invoice">Invoice</div>
                      <% if board.project.present? %><div class="btn btn-default btn-sm js-private-email">Email</div><% end %>
                      <div class="btn btn-default btn-sm js-histroy">History</div>
                      <%= link_to 'Remove',  board,  method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-default btn-sm" %>
                      <a href="<%= board_path(id: board.slug, format: :json) %>" class="btn btn-default btn-sm js-project-remove-room">Remove</a>
                  </div>
                </td>
              </tr>
            <% end %>
          <%# end %>
          </tbody>
        </table>
      <% end %>
    </div>
</div>

<div id="board-history-modal-handler"></div>
<script>
<% if params[:id].present? %>
    el = $("#project_select option[value=<%= params[:id] %>]");
    $("#project_select").val(<%= params[:id] %>);
    globalChange(el);
<% end %>
</script>